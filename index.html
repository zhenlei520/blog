<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>聽雨聲-成功來源於不斷的堅持</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="聽雨聲-成功來源於不斷的堅持">
<meta property="og:url" content="https://blogs.bflove.cn/index.html">
<meta property="og:site_name" content="聽雨聲-成功來源於不斷的堅持">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="聽雨聲">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="聽雨聲-成功來源於不斷的堅持" type="application/atom+xml">
  
  
    <link rel="icon" href="favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">聽雨聲-成功來源於不斷的堅持</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://blogs.bflove.cn"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-高级编程/反射" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/05/09/%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B/%E5%8F%8D%E5%B0%84/" class="article-date">
  <time datetime="2022-05-09T14:59:15.945Z" itemprop="datePublished">2022-05-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/05/09/%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B/%E5%8F%8D%E5%B0%84/">高级编程/反射</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2><span id="属性">属性：</span></h2><h3><span id="1-isgenerictype是否是泛型">1. IsGenericType（是否是泛型）</span></h3><pre><code>typeof(DateTime).IsGenericType : false  

typeof(List&lt;int&gt;).IsGenericType: true  

typeof(Dictionary&lt;,&gt;).IsGenericType:true</code></pre><h3><span id="1-isgenerictypedefinition获取一个值该值指示当前-type-是否表示可以用来构造其他泛型类型的泛型类型定义">1. IsGenericTypeDefinition（获取一个值，该值指示当前 Type 是否表示可以用来构造其他泛型类型的泛型类型定义）</span></h3><pre><code>typeof(List&lt;int&gt;).IsGenericTypeDefintion : false

typeof(List&lt;&gt;).IsGenericTypeDefinition :true</code></pre><h3><span id="1-isgenericparameter-表示当前类型是否是一个t类型">1. IsGenericParameter (表示当前类型是否是一个t类型)</span></h3><pre><code>typeof(List&lt;&gt;).GetGenericArguments()
返回: new Type[]{ typeof(T) }
此时: 
typeof(T).IsGenericParameter == True
typeof(T).GenericParameterPosition  == 0    

typeof(List&lt;DateTime&gt;).GetGenericArguments()
返回: new Type[]{ typeof(DateTime) }
此时: 
typeof(DateTime).IsGenericParameter  == False
typeof(DateTime).GenericParameterPosition    : throw exception</code></pre><h2><span id="方法">方法</span></h2><h3><span id="1-getgenerictypedefinition通过调用获得泛型的泛型定义">1. GetGenericTypeDefinition（通过调用获得泛型的泛型定义）</span></h3><pre><code>var listInt = typeof(List&lt;int&gt;);
var typeDef = listInt.GetGenericTypeDefinition(); // gives typeof(List&lt;&gt;)

var listDef = typeof(List&lt;&gt;);
var listStr = listDef.MakeGenericType(typeof(string));//gives typeof(List&lt;string&gt;)</code></pre><h3><span id="1-isassignablefrom-确定是否可以将指定类型的实例分配给当前类型的变量">1. IsAssignableFrom 确定是否可以将指定类型的实例分配给当前类型的变量</span></h3><pre><code>var s = typeof(IInterface).IsAssignableFrom(typeof(Parent));//True
var s2 = typeof(IInterface).IsAssignableFrom(typeof(Son));//True

public interface IInterface
{
}

public class Parent : IInterface
{
}

public class Son : Parent
{
}


public class MyClass : TypeDelegator { } 
bool status = typeof(TypeDelegator).IsAssignableFrom(typeof(MyClass)); //True

Type objType = typeof(double); 
bool status = objType.IsAssignableFrom(typeof(int)); //False</code></pre><h3><span id="1-makegenerictype函数来为泛型方法和泛型类指定泛型的类型">1. MakeGenericType函数，来为泛型方法和泛型类指定（泛型的）类型</span></h3><pre><code>using System;
using System.Reflection;

namespace RFTest
{
    //类ReflectionTest中定义了一个泛型函数DisplayType和泛型类MyGenericClass
    class ReflectionTest
    {
        //泛型类MyGenericClass有个静态函数DisplayNestedType
        public class MyGenericClass&lt;T&gt;
        {
            public static void DisplayNestedType()
            {
                Console.WriteLine(typeof(T).ToString());
            }
        }

        public void DisplayType&lt;T&gt;()
        {
            Console.WriteLine(typeof(T).ToString());
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            ReflectionTest rt = new ReflectionTest();

            MethodInfo mi = rt.GetType().GetMethod(&quot;DisplayType&quot;);//先获取到DisplayType&lt;T&gt;的MethodInfo反射对象
            mi.MakeGenericMethod(new Type[] { typeof(string) }).Invoke(rt, null);//然后使用MethodInfo反射对象调用ReflectionTest类的DisplayType&lt;T&gt;方法，这时要使用MethodInfo的MakeGenericMethod函数指定函数DisplayType&lt;T&gt;的泛型类型T

            Type myGenericClassType = rt.GetType().GetNestedType(&quot;MyGenericClass`1&quot;);//这里获取MyGenericClass&lt;T&gt;的Type对象，注意GetNestedType方法的参数要用MyGenericClass`1这种格式才能获得MyGenericClass&lt;T&gt;的Type对象
            myGenericClassType.MakeGenericType(new Type[] { typeof(float) }).GetMethod(&quot;DisplayNestedType&quot;, BindingFlags.Static | BindingFlags.Public).Invoke(null, null);
            //然后用Type对象的MakeGenericType函数为泛型类MyGenericClass&lt;T&gt;指定泛型T的类型，比如上面我们就用MakeGenericType函数将MyGenericClass&lt;T&gt;指定为了MyGenericClass&lt;float&gt;，然后继续用反射调用MyGenericClass&lt;T&gt;的DisplayNestedType静态方法

            Console.ReadLine();
        }
    }
}</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://blogs.bflove.cn/2022/05/09/%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B/%E5%8F%8D%E5%B0%84/" data-id="cl2yutseo001kdovc86uxewho" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Masa/framework/practice/1. 一行代码让你的项目轻松使用Dapr" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/04/17/Masa/framework/practice/1.%20%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%AE%A9%E4%BD%A0%E7%9A%84%E9%A1%B9%E7%9B%AE%E8%BD%BB%E6%9D%BE%E4%BD%BF%E7%94%A8Dapr/" class="article-date">
  <time datetime="2022-04-17T09:00:00.000Z" itemprop="datePublished">2022-04-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Net/">.Net</a>►<a class="article-category-link" href="/categories/Net/Framework/">Framework</a>►<a class="article-category-link" href="/categories/Net/Framework/Dapr/">Dapr</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/04/17/Masa/framework/practice/1.%20%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%AE%A9%E4%BD%A0%E7%9A%84%E9%A1%B9%E7%9B%AE%E8%BD%BB%E6%9D%BE%E4%BD%BF%E7%94%A8Dapr/">1. 一行代码让你的项目轻松使用Dapr</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>Dapr简化了云原生开发，让开发可以把焦点放在应用的业务逻辑上，从而让代码简单、可移植，那作为一个.Net开发者，我们也希望项目可以快速用上dapr，那究竟应该如何做呢？</p>
<p>Dapr提出了Sidecar(边车)的概念，在启动项目时再额外启动一个Sidecar, 通过Sidecar可以解决进程间通信，为此官方提供了两种<a href="https://docs.dapr.io/zh-hans/operations/hosting/" target="_blank" rel="noopener">部署方式</a>：</p>
<ol>
<li>自托管方式下运行Dapr</li>
<li>在 Kubernetes 模式中部署和运行 Dapr</li>
</ol>
<p>其中Kubernetes模式部署是通过Kubernetes来完成的，在开发中我们更多的是通过自托管模式使用Dapr，那自托管模式是怎么做的呢？</p>
<p>使用命令行工具，在项目根目录输入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dapr run --app-id assignment-server --app-port 5038 dotnet run</span><br></pre></td></tr></table></figure>

<blockquote>
<p>详细文档参考：<a href="https://www.cnblogs.com/doddgu/p/dapr-learning-3.html" target="_blank" rel="noopener">手把手教你学Dapr - 3. 使用Dapr运行第一个.Net程序</a></p>
</blockquote>
<p>参考以上<a href="https://www.cnblogs.com/doddgu/p/dapr-learning-3.html" target="_blank" rel="noopener">详细文档</a>操作后，我们就可以在命令行工具中执行<code>dapr invoke --app-id assignment-server --method hello</code>或者<a href="https://docs.dapr.io/zh-hans/reference/api/service_invocation_api/" target="_blank" rel="noopener">Http请求</a>来调用对应的应用的方法</p>
<p>看似好像也不是很复杂，但如果你需要调试dotnet项目呢？再复杂一点的需要启动多个项目进行调试呢？端口一多起来的确会显得很麻烦。</p>
<p>有没有什么办法可以解决呢？有，docker-compose。</p>
<p>但我还不想用这么重的东西，我想像平时开发项目一样直接在windows上运行可不可以？</p>
        
          <p class="article-more-link">
            <a href="/2022/04/17/Masa/framework/practice/1.%20%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%AE%A9%E4%BD%A0%E7%9A%84%E9%A1%B9%E7%9B%AE%E8%BD%BB%E6%9D%BE%E4%BD%BF%E7%94%A8Dapr/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://blogs.bflove.cn/2022/04/17/Masa/framework/practice/1.%20%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%AE%A9%E4%BD%A0%E7%9A%84%E9%A1%B9%E7%9B%AE%E8%BD%BB%E6%9D%BE%E4%BD%BF%E7%94%A8Dapr/" data-id="cl2yutsfo002cdovchjgv740r" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Framework/" rel="tag">Framework</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dapr/" rel="tag">dapr</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Masa/framework/practice/2. 让服务调用更简单" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/04/17/Masa/framework/practice/2.%20%E8%AE%A9%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9B%B4%E7%AE%80%E5%8D%95/" class="article-date">
  <time datetime="2022-04-17T09:00:00.000Z" itemprop="datePublished">2022-04-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Net/">.Net</a>►<a class="article-category-link" href="/categories/Net/Framework/">Framework</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/04/17/Masa/framework/practice/2.%20%E8%AE%A9%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9B%B4%E7%AE%80%E5%8D%95/">2. 让服务调用更简单 - Caller.HttpClient</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>无论是何种项目都离不开服务调用，服务的调用方式通常是基于Http、RPC协议的调用，需要获取到对应服务的域名或者ip地址以及详细的控制器方法后才能进行调用，如果项目需要支持分布式部署，则需要借助服务发现或者Nginx才能实现。</p>
<p>但随着Dapr的崛起，服务的调用方式也发生了变化，它不仅仅提供了处理重试和瞬态错误等功能，还内置服务发现，启用dapr的服务仅需知道任意一个启用dapr服务的HttpPort端口、gRpc端口、以及对应服务的appid以及对应的方法名称就可以完成调用，dapr的出现使得服务间调用变得更为的简单、方便</p>
<p>目前我们的项目是基于Http协议的调用，希望通过借助<a href="https://www.nuget.org/packages/System.Net.Http/" target="_blank" rel="noopener">HttpClient</a>或<a href="https://www.nuget.org/packages/RestSharp" target="_blank" rel="noopener">RestSharp</a>实现服务间的调用，未来有一天我们的项目会使用dapr，但不是现在</p>
        
          <p class="article-more-link">
            <a href="/2022/04/17/Masa/framework/practice/2.%20%E8%AE%A9%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9B%B4%E7%AE%80%E5%8D%95/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://blogs.bflove.cn/2022/04/17/Masa/framework/practice/2.%20%E8%AE%A9%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9B%B4%E7%AE%80%E5%8D%95/" data-id="cl2yutsfp002ddovc4hrsejge" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Framework/" rel="tag">Framework</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ElasticSearch/4. 分词" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/12/13/ElasticSearch/4.%20%E5%88%86%E8%AF%8D/" class="article-date">
  <time datetime="2021-12-13T04:29:00.000Z" itemprop="datePublished">2021-12-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/12/13/ElasticSearch/4.%20%E5%88%86%E8%AF%8D/">4. 分词</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2><span id="ik分词">IK分词</span></h2><h4><span id="ik_max_word-最细粒度划分">ik_max_word (最细粒度划分)</span></h4><blockquote>
<p>将文本做最细粒度的拆分，比如会将“我是中国人”拆分为“我，是，中国人，中国，国人”，会穷尽各种可能的组合，适合 Term Query</p>
</blockquote>
<h4><span id="ik_smart-最少切分">ik_smart (最少切分)</span></h4><blockquote>
<p>做最粗粒度的拆分，比如会将“我是中国人”拆分为“我，是，中国人”，适合 Phrase 查询</p>
</blockquote>
<blockquote>
<p>扩展字典：用于创建分词的字典</p>
<p>停止字典：用于过滤的字典，也就是说，该字典的单词或者字符串都会进行过滤</p>
</blockquote>
<h2><span id="使用分词">使用分词</span></h2><h4><span id="测试分词">测试分词</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;_analyze</span><br><span class="line">&#123;</span><br><span class="line">  &quot;analyzer&quot;: &quot;ik_max_word&quot;,</span><br><span class="line">  &quot;text&quot;: &quot;乔碧萝殿下&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://blogs.bflove.cn/2021/12/13/ElasticSearch/4.%20%E5%88%86%E8%AF%8D/" data-id="cl2yutse4000sdovc1tq4g5mj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Es/" rel="tag">Es</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ElasticSearch/3. 字段类型" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/12/13/ElasticSearch/3.%20%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B/" class="article-date">
  <time datetime="2021-12-13T04:29:00.000Z" itemprop="datePublished">2021-12-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/12/13/ElasticSearch/3.%20%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B/">3. 字段类型</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2><span id="核心类型">核心类型</span></h2><ul>
<li>字符串（string）<blockquote>
<p>text (无长度限制)，keyword (不希望被分词、最长长度是 32766 字节)</p>
</blockquote>
</li>
<li>数字类型（Numeric）<blockquote>
<p>long, integer, short, byte, double, float, half_float, scaled_float</p>
</blockquote>
</li>
<li>日期类型（Date）<blockquote>
<p>date</p>
</blockquote>
</li>
<li>布尔类型（Boolean）<blockquote>
<p>boolean</p>
</blockquote>
</li>
<li>二进制类型（Binary）<blockquote>
<p>binary</p>
</blockquote>
</li>
</ul>
<h2><span id="复合类型">复合类型</span></h2><ul>
<li>数组类型（Array）<blockquote>
<p>Array 支持不针对特定的数据类型</p>
</blockquote>
</li>
<li>对象类型（Object）<blockquote>
<p>object 用于单个JSON对象的对象</p>
</blockquote>
</li>
<li>嵌套类型（Nested）<blockquote>
<p>nested 用于JSON对象的数组</p>
</blockquote>
</li>
</ul>
<h2><span id="地理类型geo">地理类型（Geo）</span></h2><ul>
<li>地理坐标（Geo-point）<blockquote>
<p>geo_point 纬度/经度坐标</p>
</blockquote>
</li>
<li>地理圆形（Geo-shape）<blockquote>
<p>geo_shape 用于多边形等复杂形状</p>
</blockquote>
</li>
</ul>
<h2><span id="特定类型">特定类型</span></h2><ul>
<li>IP 类型（IP）<blockquote>
<p>ip 用于描述 IPv4 和 IPv6 地址</p>
</blockquote>
</li>
<li>补全类型（Completion）<blockquote>
<p>completion 提供自动完成提示</p>
</blockquote>
</li>
<li>令牌计数类型（Token count）<blockquote>
<p>token_count 用来统计字符串中词条的数量</p>
</blockquote>
</li>
<li>附件类型（attachment）<blockquote>
<p>参考 mapper-attachments 插件，支持将附件例如Microsoft Office格式，open document格式，ePub，HTML等索引为 attachment 数据类型。</p>
</blockquote>
</li>
<li>抽取类型（Percolator）<blockquote>
<p>接受来自领域特定语言（query-dsl）的查询</p>
</blockquote>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://blogs.bflove.cn/2021/12/13/ElasticSearch/3.%20%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B/" data-id="cl2yutse7000vdovcarl9evsx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Es/" rel="tag">Es</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ElasticSearch/5. Index、Type选型" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/12/13/ElasticSearch/5.%20Index%E3%80%81Type%E9%80%89%E5%9E%8B/" class="article-date">
  <time datetime="2021-12-13T04:29:00.000Z" itemprop="datePublished">2021-12-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/12/13/ElasticSearch/5.%20Index%E3%80%81Type%E9%80%89%E5%9E%8B/">5. Index、Type选型</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在过去，我们试图通过与关系数据库建立类比来使弹性搜索更容易理解：索引index就像数据库一样，类型type似于数据库中的表。这是一个错误：数据的存储方式是如此不同，以至于任何比较几乎都没有意义，这最终会导致在有害的情况下过度使用类型。</p>
<h2><span id="index是什么">index是什么</span></h2><p>索引index存储在一系列分片中，它们本身就是Lucene index。所以使用新索引应该注意：Lucene索引在磁盘空间，内存使用和使用的文件描述符方面有一个小而固定的开销。因此，单个大index比几个小index效率更高，Lucene index的固定开销更好地摊销在多个文档中。</p>
<p>另一个重要因素是如何搜索数据,虽然每个分片都是独立搜索的，但Elasticsearch最终需要合并所有搜索分片的结果。例如，搜索10个index,每个index有5个分片，则协调搜索请求执行的节点将需要合并5x10 = 50个分片结果。在这里需要注意：如果有太多的分片结果要合并，或者运行了一个产生大量分片响应的大量请求，合并这些分片结果的任务会非常消耗CPU和内存资源。这也是提倡少用index的原因。</p>
<h2><span id="type是什么">type是什么</span></h2><p>使用type允许我们在一个index里存储多种类型的数据，这样就可以减少index的数量了。在使用时，向每个文档加入_type 字段，在指定type搜索时就会被用于过滤。使用type的一个好处是，搜索一个index下的多个type，和只搜索一个type相比没有额外的开销 —— 需要合并结果的分片数量是一样的。</p>
<p>但是，这也是有限制的：</p>
<ul>
<li>不同type里的字段需要保持一致。例如，一个index下的不同type里有两个名字相同的字段，他们的类型（string, date 等等）和配置也必须相同。</li>
<li>只在某个type里存在的字段，在其他没有该字段的 type 中也会消耗资源。这是Lucene Index带来的常见问题：它不喜欢稀疏。由于连续文档之间的差异太大，稀疏的 posting list 的压缩效率不高。这个问题在 doc value 上更为严重：为了提高速度，doc value 通常会为每个文档预留一个固定大小的空间，以便文档可以被高速检索。这意味着，如果 Lucene 确定它需要一个字节来存储某个数字类型的字段，它同样会给没有这个字段的文档预留一个字节。未来版本的 ES 会在这方面做一些改进，但是我仍然建议你在建模的时候尽量避免稀疏。[1]</li>
<li>得分是由index内的统计数据来决定的。也就是说，一个 type 中的文档会影响另一个 type 中的文档的得分。<br>这意味着，只有同一个index的中的 type 都有类似的映射 (mapping) 时，才应该使用 type。否则，使用多个type可能比使用多个index消耗的资源更多。</li>
</ul>
<h2><span id="如何选择">如何选择</span></h2><p>这是个困难的问题，它的答案取决于你用的硬件、数据和用例。首先你要明白 type 是有用的，因为它能减少 ES 需要管理的Lucene Index的数量。但是也有另外一种方式可以减少这个数量：创建 index 的时候让它的分片少一些。例如，与其在一个 index 里塞上 5 个 type，不如创建 5 个只有一个分片的 index。</p>
<p>在你做决定的时候可以问自己下面几个问题：</p>
<ul>
<li>你需要使用父子文档吗？如果需要，只能在一个 index 里建立多个 type。</li>
<li>你的文档的映射是否相似？如果不相似，使用多个 index。</li>
<li>如果你的每个 type 都有足够多的文档，Lucene Index 的开销可以被分摊掉，你就可以安全的使用多个 index 了。如果有必要的话，可以把分片数量设小一点。</li>
<li>如果文档不够多，你可以考虑把文档放进一个 index 里的多个 type 里，甚至放进一个 type 里。</li>
</ul>
<p>总之，你可能有点惊讶，因为 type 的使用场景没有你想象的多，这是正确的。由于我们上面提到原因，在一个 index 中使用多个 type 的情景其实很少。如果你的数据有不同的映射，那就给他们分配不同的 index。但是请记住，如果不需要很高的写入吞吐量，或者存储的文档数量不多，你可以通过减少 index 的分片来使集群中的分片数量保持合理。</p>
<h2><span id="总结">总结</span></h2><p>如非必要尽量不要使用type，type的存在是因为历史原因所造成的，官方提到在8.x版本会彻底移除type，默认type是_doc</p>
<p>原文链接：<a href="https://blog.csdn.net/tengxing007/article/details/100663530" target="_blank" rel="noopener">https://blog.csdn.net/tengxing007/article/details/100663530</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://blogs.bflove.cn/2021/12/13/ElasticSearch/5.%20Index%E3%80%81Type%E9%80%89%E5%9E%8B/" data-id="cl2yutse8000wdovceydqedsw" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Es/" rel="tag">Es</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ElasticSearch/2. 常用dsl" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/12/13/ElasticSearch/2.%20%E5%B8%B8%E7%94%A8dsl/" class="article-date">
  <time datetime="2021-12-13T02:29:00.000Z" itemprop="datePublished">2021-12-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/12/13/ElasticSearch/2.%20%E5%B8%B8%E7%94%A8dsl/">2. 常用dsl</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2><span id="查询">查询</span></h2><ol>
<li>match</li>
</ol>
<ul>
<li>进行分词、根据lucene的评分机制(TF/IDF)来进行评分</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match&quot;: &#123;</span><br><span class="line">        &quot;content&quot; : &#123;</span><br><span class="line">            &quot;query&quot; : &quot;我的宝马多少马力&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>match_phrase</li>
</ol>
<ul>
<li>精确匹配(完全匹配)</li>
<li>通过可调节因子，少匹配一个也满足(slop)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match_phrase&quot;: &#123;</span><br><span class="line">        &quot;content&quot; : &#123;</span><br><span class="line">            &quot;query&quot; : &quot;我的宝马多少马力&quot;,</span><br><span class="line">            &quot;slop&quot; : 1</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>multi_match</li>
</ol>
<ul>
<li><p>多字段匹配，其中一个字段有这个文档就满足的话可以使用 (multi_match)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;multi_match&quot;: &#123;</span><br><span class="line">        &quot;query&quot; : &quot;我的宝马多少马力&quot;,</span><br><span class="line">        &quot;fields&quot; : [&quot;title&quot;, &quot;content&quot;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>希望完全匹配的文档占的评分比较高，使用best_fields</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;multi_match&quot;: &#123;</span><br><span class="line">      &quot;query&quot;: &quot;我的宝马发动机多少&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;best_fields&quot;,</span><br><span class="line">      &quot;fields&quot;: [</span><br><span class="line">        &quot;tag&quot;,</span><br><span class="line">        &quot;content&quot;</span><br><span class="line">      ],</span><br><span class="line">      &quot;tie_breaker&quot;: 0.3</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>完全匹配”宝马 发动机”的文档评分会比较靠前，如果只匹配宝马的文档评分乘以0.3的系数</p>
</blockquote>
</li>
<li><p>越多字段匹配的文档评分越高，使用most_fields</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;multi_match&quot;: &#123;</span><br><span class="line">      &quot;query&quot;: &quot;我的宝马发动机多少&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;most_fields&quot;,</span><br><span class="line">      &quot;fields&quot;: [</span><br><span class="line">        &quot;tag&quot;,</span><br><span class="line">        &quot;content&quot;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>希望这个词条的分词词汇是分配到不同字段中的，使用cross_fields</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;multi_match&quot;: &#123;</span><br><span class="line">      &quot;query&quot;: &quot;我的宝马发动机多少&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;cross_fields&quot;,</span><br><span class="line">      &quot;fields&quot;: [</span><br><span class="line">        &quot;tag&quot;,</span><br><span class="line">        &quot;content&quot;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol start="4">
<li>term</li>
</ol>
<ul>
<li>完全匹配, 不进行分词器分析，文档中必须包含整个搜索的词汇</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;term&quot;: &#123;</span><br><span class="line">      &quot;content&quot;: &quot;汽车保养&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>查出的所有文档都包含”汽车保养”这个词组的词汇</p>
</blockquote>
<p>疑问：</p>
<ul>
<li>文档中包含汽车保养，但却搜索不到：<ul>
<li>检查查询的字段是否存在分词，若存在分词，则检查分词的词汇中是否存在搜索的内容</li>
</ul>
</li>
</ul>
<h2><span id="filter-结果过滤">filter 结果过滤</span></h2><h4><span id="range过滤-允许我们按照指定范围查找一批数据">range过滤 允许我们按照指定范围查找一批数据</span></h4><blockquote>
<p>gt：大于</p>
<p>gte：大于等于</p>
<p>lt：小于</p>
<p>lte：小于等于</p>
</blockquote>
<h4><span id="bool-过滤">bool 过滤</span></h4><blockquote>
<p>must: 多个查询条件的完全匹配，相当于and</p>
<p>must_not：多个查询条件的相反匹配，相当于not</p>
<p>should：至少有一个查询条件匹配, 相当于or</p>
<p>match_all：可以查询到所有文档，是没有查询条件下的默认语句</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;bool&quot;: &#123;</span><br><span class="line">      &quot;must&quot;: &#123;</span><br><span class="line">        &quot;term&quot;: &#123;</span><br><span class="line">          &quot;content&quot;: &quot;宝马&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;must_not&quot;: &#123;</span><br><span class="line">        &quot;term&quot;: &#123;</span><br><span class="line">          &quot;tags&quot;: &quot;宝马&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>请求”content中带宝马，但是tag中不带宝马”这样类似的需求</p>
</blockquote>
<h2><span id="总结">总结</span></h2><blockquote>
<p>使用 filter 来替代 must 查询，需要注意的是，使用filter查询出的结果和must查询出的结果是一致的，差异仅是没有相关性得分</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://blogs.bflove.cn/2021/12/13/ElasticSearch/2.%20%E5%B8%B8%E7%94%A8dsl/" data-id="cl2yutse2000odovcd9pf9imh" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Es/" rel="tag">Es</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ElasticSearch/1. 常用API" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/12/13/ElasticSearch/1.%20%E5%B8%B8%E7%94%A8API/" class="article-date">
  <time datetime="2021-12-13T02:29:00.000Z" itemprop="datePublished">2021-12-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/12/13/ElasticSearch/1.%20%E5%B8%B8%E7%94%A8API/">1. 常用API</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2><span id="常用api">常用API</span></h2><h4><span id="查看所有节点">查看所有节点</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;_cat&#x2F;nodes:</span><br><span class="line"></span><br><span class="line">例：http:&#x2F;&#x2F;localhost:9200&#x2F;_cat&#x2F;nodes</span><br><span class="line"></span><br><span class="line">&gt; 172.17.0.2 19 79 0 0.04 0.05 0.07 cdfhilmrstw * 861f61771322</span><br><span class="line"></span><br><span class="line">其中* 表示主节点</span><br></pre></td></tr></table></figure>

<h4><span id="查看es健康状况">查看es健康状况</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;_cat&#x2F;health:</span><br><span class="line"></span><br><span class="line">例：http:&#x2F;&#x2F;localhost:9200&#x2F;_cat&#x2F;health</span><br><span class="line"></span><br><span class="line">&gt; 1639363151 02:39:11 docker-cluster green 1 1 1 1 0 0 0 0 - 100.0%</span><br><span class="line"></span><br><span class="line">其中green指的是健康状况（green表示健康）、1 1 1 1 0 0 0 0 - 100.0%是集群分片信息</span><br></pre></td></tr></table></figure>

<h4><span id="查看主节点">查看主节点</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;_cat&#x2F;master:</span><br><span class="line"></span><br><span class="line">例：http:&#x2F;&#x2F;localhost:9200&#x2F;_cat&#x2F;master</span><br><span class="line"></span><br><span class="line">&gt; _pT9AHiNSWOnvlH4ko71yw 172.17.0.2 172.17.0.2 861f61771322</span><br><span class="line"></span><br><span class="line">其中_pT9AHiNSWOnvlH4ko71yw是主节点唯一编号、172.17.0.2 172.17.0.2是虚拟机地址、861f61771322是主节点名字</span><br></pre></td></tr></table></figure>

<h4><span id="查看所有索引">查看所有索引</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;_cat&#x2F;indices: 相当于MySQL的show databases;</span><br><span class="line"></span><br><span class="line">例：http:&#x2F;&#x2F;localhost:9200&#x2F;_cat&#x2F;indices</span><br><span class="line"></span><br><span class="line">&gt; green open .geoip_databases YDS9IJ47TGiOyOMfFBA_XA 1 0 42 42 43.8mb 43.8mb</span><br><span class="line"></span><br><span class="line">索引具体信息</span><br></pre></td></tr></table></figure>

<h2><span id="文档增删改查">文档增删改查</span></h2><p>格式：</p>
<h4><span id="增加">增加</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;user_index&#x2F;_doc&#x2F;1 </span><br><span class="line">&#123;</span><br><span class="line">    &quot;name&quot;:&quot;zhangsan&quot;,</span><br><span class="line">    &quot;gender&quot;:1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>索引：user_index、类型：_doc、文档原始内容：{“name”:”zhangsan”,”gender”:1}，其中索引id: 1，用于新增数据，不指定id为1时，id是随机生成的</p>
</blockquote>
<h4><span id="修改">修改</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Put &#x2F;user_index&#x2F;_doc&#x2F;1 </span><br><span class="line">&#123;</span><br><span class="line">    &quot;name&quot;:&quot;lisi&quot;,</span><br><span class="line">    &quot;gender&quot;:1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>索引：user_index、类型：_doc、文档原始内容：{“name”:”lisi”,”gender”:1}，其中索引id: 1，用于新增（当指定id不存在时）或者修改（指定id存在时）</p>
</blockquote>
<h4><span id="查询">查询</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET: &#x2F;user_index&#x2F;_doc&#x2F;_search</span><br></pre></td></tr></table></figure>
<blockquote>
<p>索引：user_index、类型：_doc，默认会搜索会返回前10个结果<br>支持条件: q=*&amp;sort=account_number:asc</p>
</blockquote>
<h4><span id="根据id指定查询详情">根据id指定查询详情</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET: &#x2F;user_index&#x2F;_doc&#x2F;1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>索引：user_index、类型：_doc，返回id为1的详细信息</p>
</blockquote>
<h3><span id="根据id删除信息">根据id删除信息</span></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE: &#x2F;user_index&#x2F;_doc&#x2F;1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>索引：user_index、类型：_doc，删除id为1的信息</p>
</blockquote>
<h2><span id="索引">索引</span></h2><h4><span id="删除索引">删除索引</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE: &#x2F;user_index</span><br></pre></td></tr></table></figure>
<blockquote>
<p>删除索引为user_index的所有数据</p>
</blockquote>
<h2><span id="mapping映射">Mapping映射</span></h2><h4><span id="查看mapping信息">查看mapping信息</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;user_index&#x2F;_mapping</span><br><span class="line"></span><br><span class="line">&gt; 索引：user_index</span><br></pre></td></tr></table></figure>

<h4><span id="修改mapping信息">修改mapping信息</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PUT &#x2F;user_index</span><br><span class="line">&#123;</span><br><span class="line">  &quot;mappings&quot;: &#123;&#x2F;&#x2F;映射规则</span><br><span class="line">    &quot;properties&quot;: &#123;</span><br><span class="line">      &quot;gender&quot;:  &#123; &quot;type&quot;: &quot;long&quot;  &#125;,&#x2F;&#x2F;keyword不会进行全文检索 </span><br><span class="line">      &quot;name&quot;:   &#123; &quot;type&quot;: &quot;text&quot;  &#125;&#x2F;&#x2F;text保存的时候进行分词，搜索的时候进行全文检索   </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2><span id="索引迁移">索引迁移</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;_reindex</span><br><span class="line">&#123;</span><br><span class="line">  &quot;source&quot;: &#123;</span><br><span class="line">    &quot;index&quot;: &quot;bank&quot;,</span><br><span class="line">    &quot;type&quot;: &quot;account&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;dest&quot;: &#123;</span><br><span class="line">    &quot;index&quot;: &quot;newbank&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2><span id="总结">总结</span></h2><ol>
<li>Es可直接删除文档和索引、但不支持删除类型，删除索引后，就会删除这个索引下所有的类型</li>
<li></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://blogs.bflove.cn/2021/12/13/ElasticSearch/1.%20%E5%B8%B8%E7%94%A8API/" data-id="cl2yutse3000rdovccq89fl5p" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Es/" rel="tag">Es</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Dapr/二、认识Dapr" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/11/01/Dapr/%E4%BA%8C%E3%80%81%E8%AE%A4%E8%AF%86Dapr/" class="article-date">
  <time datetime="2021-11-01T03:42:58.000Z" itemprop="datePublished">2021-11-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/01/Dapr/%E4%BA%8C%E3%80%81%E8%AE%A4%E8%AF%86Dapr/">二、认识Dapr</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Dapr特性：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. State management 状态管理</span><br><span class="line">2. Publish &amp; subscribe 发布&amp;订阅</span><br><span class="line">3. Bindings 资源绑定</span><br><span class="line">4. Actors </span><br><span class="line">5. Observability 可观测性</span><br><span class="line">6. Secrets 机密</span><br><span class="line">7. Extensibility 扩展性</span><br><span class="line">8. Service invocation 服务调用</span><br></pre></td></tr></table></figure>

<p><img src="/2021/11/01/Dapr/%E4%BA%8C%E3%80%81%E8%AE%A4%E8%AF%86Dapr/building-blocks.png" alt="Dapr特性"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://blogs.bflove.cn/2021/11/01/Dapr/%E4%BA%8C%E3%80%81%E8%AE%A4%E8%AF%86Dapr/" data-id="cl2yutsds000bdovc59kr9sxz" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-EFCore查询优化/trackBug" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/22/EFCore%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96/trackBug/" class="article-date">
  <time datetime="2021-10-22T02:45:00.000Z" itemprop="datePublished">2021-10-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/10/22/EFCore%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96/trackBug/">trackBug</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3><span id="错误提示">错误提示：</span></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">The instance of entity type &#39;CatalogBrand&#39; cannot be tracked </span><br><span class="line">because another instance with the same key value for &#123;&#39;Id&#39;&#125; is already being tracked. </span><br><span class="line">When attaching existing entities, ensure that only one entity instance with a given key value is attached. </span><br><span class="line">Consider using &#39;DbContextOptionsBuilder.EnableSensitiveDataLogging&#39; to see the conflicting key values.</span><br></pre></td></tr></table></figure>

<h3><span id="场景再现">场景再现：</span></h3><p>基本类</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">public class CatalogBrand</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F;&#x2F; &lt;summary&gt;</span><br><span class="line">    &#x2F;&#x2F;&#x2F; 主键id，自增</span><br><span class="line">    &#x2F;&#x2F;&#x2F; &lt;&#x2F;summary&gt;</span><br><span class="line">    public int Id &#123; get; set; &#125;</span><br><span class="line"></span><br><span class="line">    public string Brand &#123; get; set; &#125; &#x3D; null!;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class CatalogBrandEntityTypeConfiguration</span><br><span class="line">    : IEntityTypeConfiguration&lt;CatalogBrand&gt;</span><br><span class="line">&#123;</span><br><span class="line">    public void Configure(EntityTypeBuilder&lt;CatalogBrand&gt; builder)</span><br><span class="line">    &#123;</span><br><span class="line">        builder.ToTable(&quot;CatalogBrand&quot;);</span><br><span class="line"></span><br><span class="line">        builder.HasKey(ci &#x3D;&gt; ci.Id);</span><br><span class="line"></span><br><span class="line">        builder.Property(ci &#x3D;&gt; ci.Id)</span><br><span class="line">           .IsRequired();</span><br><span class="line"></span><br><span class="line">        builder.Property(cb &#x3D;&gt; cb.Brand)</span><br><span class="line">            .IsRequired()</span><br><span class="line">            .HasMaxLength(100);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class CatalogDbContext : DbContext</span><br><span class="line">&#123;</span><br><span class="line">    public DbSet&lt;CatalogBrand&gt; CatalogBrands &#123; get; set; &#125; &#x3D; null!;</span><br><span class="line"></span><br><span class="line">    public CatalogDbContext(DbContextOptions&lt;CatalogDbContext&gt; options) : base(options)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected override void OnModelCreating(ModelBuilder builder)</span><br><span class="line">    &#123;</span><br><span class="line">        builder.ApplyConfiguration(new CatalogBrandEntityTypeConfiguration());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>出错方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">public void TestAsync([FromServices] CatalogDbContext dbContext)</span><br><span class="line">&#123;</span><br><span class="line">    var addBrand &#x3D; new CatalogBrand()</span><br><span class="line">    &#123;</span><br><span class="line">        Brand &#x3D; &quot;apple&quot;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    var entityEntry &#x3D; new EntityEntry(dbContext.GetDependencies().StateManager.GetOrCreateEntry(addBrand, dbContext.Model.FindEntityType(nameof(CatalogBrand))));</span><br><span class="line">    var trackState &#x3D; entityEntry.GetInfrastructure();&#x2F;&#x2F;得到当前实体是否被跟踪</span><br><span class="line"></span><br><span class="line">    dbContext.CatalogBrands.Add(addBrand);</span><br><span class="line"></span><br><span class="line">    trackState &#x3D; entityEntry.GetInfrastructure();</span><br><span class="line"></span><br><span class="line">    dbContext.SaveChanges();</span><br><span class="line">    try</span><br><span class="line">    &#123;</span><br><span class="line">        var brand &#x3D; dbContext.CatalogBrands.FirstOrDefault(x &#x3D;&gt; x.Id &#x3D;&#x3D; addBrand.Id)!;</span><br><span class="line">        var updateEntityEntry &#x3D; new EntityEntry(dbContext.GetDependencies().StateManager.GetOrCreateEntry(brand, dbContext.Model.FindEntityType(nameof(CatalogBrand))));</span><br><span class="line">        trackState &#x3D; updateEntityEntry.GetInfrastructure();</span><br><span class="line">        brand.Brand &#x3D; &quot;huawei&quot;;</span><br><span class="line">        dbContext.Update(brand);&#x2F;&#x2F;运行到此处，提示entity type &#39;CatalogBrand&#39; cannot be tracked </span><br><span class="line">        dbContext.SaveChanges();</span><br><span class="line">    &#125;</span><br><span class="line">    catch (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(ex.Message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3><span id="问题解析">问题解析：</span></h3><p>分析前先思考下面几个问题: </p>
<ol>
<li>在根据id查询到品牌后执行Update操作出错，提示当前entity type ‘CatalogBrand’ cannot be tracked ，证明此类在之前已经被跟踪</li>
<li>明明我们设置的全局不跟踪为何又会被再次跟踪？</li>
</ol>
<p>下面我们一步步的排查原因：</p>
<p>首先在调用Add方法之前查看到当前并未跟踪任何信息</p>
<p><img src="/2021/10/22/EFCore%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96/trackBug/3.png" alt="Add之前"></p>
<p>然后执行Add操作后得到如下结果：</p>
<p><img src="/2021/10/22/EFCore%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96/trackBug/4.png" alt="Add之后"></p>
<p>在此我们得到一个结果，执行添加操作后会更新当前的实体，翻看源码后确定了我们的猜想：</p>
<p><img src="/2021/10/22/EFCore%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96/trackBug/1.png" alt="Add Source"></p>
<p><img src="/2021/10/22/EFCore%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96/trackBug/2.png" alt="Add Source"></p>
<p>紧接着我们再根据id查询实体，得到如下结果</p>
<p><img src="/2021/10/22/EFCore%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96/trackBug/5.jpg" alt="Select"></p>
<p>然后再执行Update，开始抛出异常entity type ‘CatalogBrand’ cannot be tracked </p>
<p>我们都知道Update中会判断是否跟踪，如果未被跟踪，则先添加跟踪后，再更新信息，由于我们查询到的结果是未被跟踪的，所以会执行Attach，但之前我们在执行Add后已经跟踪当前id的Entity，所以就报错了，那如何解决呢？</p>
<p>我们在跟踪操作完后进行分离即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dbContext.Entry&lt;CatalogBrand&gt;(brand).State &#x3D; EntityState.Detached;&#x2F;&#x2F;让实体独立，不再跟踪</span><br></pre></td></tr></table></figure>

<p>那所有的原因我们就找到了，由于Add、Update等操作后会对实体重新跟踪，所以下方操作的时候就不能再执行再次Attach的操作，又或者每次操作完都进行分离，那下次还可以再进行Attach。</p>
<p>当然也会有人说我之前一直是查询出来再执行Update，也从没遇到错误，为何这次遇到了呢？这个可以找一下之前的操作是不是没有设置QueryTrackingBehavior.NoTracking，如果我们没有设置不跟踪的话，默认EF是全局跟踪的，正是因为全局跟踪，所以每次查询的时候EF会先从跟踪实体中查询是否有数据，如果有就直接返回，否则再查询新的实体，这块在<a href="https://docs.microsoft.com/zh-cn/ef/core/querying/how-query-works?source=docs#the-life-of-a-query" target="_blank" rel="noopener">官方文档</a>也有说明。如果是不跟踪，那全部都获取新的实体，不再从原来跟踪的实体中查询，所以这也导致我们在查询后得到的实体不是之前跟踪的那个实体，尽管两次的值是一样的。</p>
<p>既然改为不跟踪有这么多坑，为何我们还要改为不跟踪呢？原因有以下几点：</p>
<ol>
<li>改为不跟踪后我们每次得到的结果是当前数据库的最新结果，不会从已跟踪的实体中获取，那就会使得我们可以获取到最新的结果，而不是旧的数据，这对高并发的场景来说是需要的</li>
<li>跟踪意味着性能损耗，当不跟踪后我们的性能会有提升</li>
</ol>
<p>如果我们只是对某几个查询不跟踪，不需要对全局不跟踪，也可以使用<a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.entity.queryableextensions.asnotracking?view=entity-framework-6.2.0" target="_blank" rel="noopener">NoTracking()</a>方法，例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var brand &#x3D; dbContext.CatalogBrands.Where(x &#x3D;&gt; x.Id &#x3D;&#x3D; addBrand.Id).AsNoTracking().FirstOrDefault()!;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://blogs.bflove.cn/2021/10/22/EFCore%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96/trackBug/" data-id="cl2yutsdz000kdovc250q5fyg" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Net/">.Net</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Net/Framework/">Framework</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Net/Framework/Dapr/">Dapr</a></li></ul></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSharp%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/" rel="tag">CSharp基础语法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DI-%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/" rel="tag">DI 依赖注入</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ElasticSearch/" rel="tag">ElasticSearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Es/" rel="tag">Es</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Framework/" rel="tag">Framework</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IOC/" rel="tag">IOC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NetCore/" rel="tag">NetCore</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NetCore%E9%94%99%E8%AF%AF/" rel="tag">NetCore错误</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dapr/" rel="tag">dapr</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%85%8D%E7%BD%AE-Configuration/" rel="tag">配置(Configuration)</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CSharp%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/" style="font-size: 16px;">CSharp基础语法</a> <a href="/tags/DI-%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/" style="font-size: 10px;">DI 依赖注入</a> <a href="/tags/Docker/" style="font-size: 14px;">Docker</a> <a href="/tags/ElasticSearch/" style="font-size: 20px;">ElasticSearch</a> <a href="/tags/Es/" style="font-size: 18px;">Es</a> <a href="/tags/Framework/" style="font-size: 12px;">Framework</a> <a href="/tags/IOC/" style="font-size: 10px;">IOC</a> <a href="/tags/NetCore/" style="font-size: 10px;">NetCore</a> <a href="/tags/NetCore%E9%94%99%E8%AF%AF/" style="font-size: 10px;">NetCore错误</a> <a href="/tags/dapr/" style="font-size: 10px;">dapr</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 12px;">设计模式</a> <a href="/tags/%E9%85%8D%E7%BD%AE-Configuration/" style="font-size: 10px;">配置(Configuration)</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/05/09/%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B/%E5%8F%8D%E5%B0%84/">高级编程/反射</a>
          </li>
        
          <li>
            <a href="/2022/04/17/Masa/framework/practice/1.%20%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%AE%A9%E4%BD%A0%E7%9A%84%E9%A1%B9%E7%9B%AE%E8%BD%BB%E6%9D%BE%E4%BD%BF%E7%94%A8Dapr/">1. 一行代码让你的项目轻松使用Dapr</a>
          </li>
        
          <li>
            <a href="/2022/04/17/Masa/framework/practice/2.%20%E8%AE%A9%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9B%B4%E7%AE%80%E5%8D%95/">2. 让服务调用更简单 - Caller.HttpClient</a>
          </li>
        
          <li>
            <a href="/2021/12/13/ElasticSearch/4.%20%E5%88%86%E8%AF%8D/">4. 分词</a>
          </li>
        
          <li>
            <a href="/2021/12/13/ElasticSearch/3.%20%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B/">3. 字段类型</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 聽雨聲<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>